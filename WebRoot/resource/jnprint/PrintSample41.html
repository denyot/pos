<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>WEB打印控件LODOP的样例四十一:内容关联后顺序打印</title>

<script language="javascript" src="LodopFuncs.js"></script>
<object id="LODOP" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0> 
	<embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="install_lodop.exe"></embed>
</object> 
</head>
<body>

<h2><font color="#009999">演示内容关联后按顺序打印：</font></h2>
<p>&nbsp;&nbsp;&nbsp; 利用<font color="#0000FF">SET_PRINT_STYLEA</font>的类型<font color="#0000FF">“LinkedItem”</font>可以把两个独立的内容关联起来，让它们顺序打印,</p>                           
<p>一个内容关联别人后，其Top值是与被关联者的间隙距离，二者同是多页项时则高度一致。</p>                        
<h2><font color="#009999">演示：</font></h2>  
<p>1：分页打印后面的表格后，紧跟表格末尾加上制表日期和制表者,其程序代码如下：</p>      
<textarea rows="8" id="code1" cols="94">
LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_打印关联内容一");
LODOP.ADD_PRINT_TABLE(100,5,500,280,document.getElementById("tablediv").innerHTML);
LODOP.ADD_PRINT_TEXT(15,50,200,25,"制表日期:"+LODOP.FORMAT("TIME:YYYY年MM月DD日","DATE"));
LODOP.SET_PRINT_STYLEA(0,"LinkedItem",1);
LODOP.ADD_PRINT_TEXT(15,300,200,25,"单表制表:guest");
LODOP.SET_PRINT_STYLEA(0,"LinkedItem",1);   
</textarea> 
<br>
用以上代码执行<a href="javascript:myDesign01();">打印设计1</a>或<a href="javascript:myPeview01();">预览打印1</a> 

 　<p>2：把该表格顺序打印两遍后，再紧跟打印制表日期和制表者,其程序代码如下：</p>
 <textarea rows="9" id="code2" cols="94">
LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_打印关联内容二");
LODOP.ADD_PRINT_TABLE(100,5,500,280,document.getElementById("tablediv").innerHTML);
LODOP.ADD_PRINT_TABLE(26,0,500,280,document.getElementById("tablediv").innerHTML);
LODOP.SET_PRINT_STYLEA(0,"LinkedItem",1);
LODOP.ADD_PRINT_TEXT(15,50,200,25,"制表日期:"+LODOP.FORMAT("TIME:YYYY年MM月DD日","DATE"));
LODOP.SET_PRINT_STYLEA(0,"LinkedItem",2);
LODOP.ADD_PRINT_TEXT(15,300,200,25,"双表输出:Admin");
LODOP.SET_PRINT_STYLEA(0,"LinkedItem",2);     
</textarea> 

<p>
用以上代码执行<a href="javascript:myDesign02();">打印设计2</a>或<a href="javascript:myPeview02();">预览打印2</a>。</p>

<div id="tablediv">

<table border=1 width="452" height="579">

<thead>
<tr><th width="218" height="16">设备编号</th>
<th width="218" height="16">设备名称
</th>
</tr>
</thead>

<tbody>
<tr>
<td width="218" height="8">001</td>        
<td width="218" height="8">电脑</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">002</td>
<td width="218" height="16"><span dataFld=TITLE>腹腔镜器械</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">003</td>
<td width="218" height="16">工作手件</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">004</td>
<td width="218" height="16"><span dataFld=TITLE>陈列柜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">005</td>
<td width="218" height="16"><span dataFld=TITLE>不锈钢紫外线消毒车</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">006</td>
<td width="218" height="16"><span dataFld=TITLE>刻录机</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">007</td>
<td width="218" height="16">抓钳</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="12">008</td>
<td width="218" height="12">冷光源灯</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">009</td>
<td width="218" height="16"><span dataFld=TITLE>手术床</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">010</td>
<td width="218" height="16"><span dataFld=TITLE>手术无影灯</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">011</td>
<td width="218" height="16"><span dataFld=TITLE>手术无影灯</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">012</td>
<td width="218" height="16">纤维导光头灯</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">013</td>
<td width="218" height="16"><span dataFld=TITLE>电切镜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">014</td>
<td width="218" height="16"><span dataFld=TITLE>电切镜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">015</td>
<td width="218" height="16"><span dataFld=TITLE>鼻窦镜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">016</td>
<td width="218" height="16"><span dataFld=TITLE>腹腔镜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">017</td>
<td width="218" height="16"><span dataFld=TITLE>关节镜光学视管</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">018</td>
<td width="218" height="16">经皮肾镜</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">019</td>
<td width="218" height="16">输尿管镜</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">020</td>
<td width="218" height="16"><span dataFld=TITLE>纤维导光关节镜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">021</td>
<td width="218" height="16"><span dataFld=TITLE>纤维导光关节镜</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">022</td>
<td width="218" height="16"><span dataFld=TITLE>可见分光光度计</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">023</td>
<td width="218" height="16"><span dataFld=TITLE>酸度计</span></td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">024</td>
<td width="218" height="16">电热三用水箱</td>
</tr></tbody>
<tbody>
<tr>
<td width="218" height="16">025</td>
<td width="218" height="16"><span dataFld=TITLE>TDP治疗机</span></td>
</tr></tbody>

<tfoot>
<tr><th width="218" height="13">设备号</th><th width="218" height="13">设备名</th></tr>
</tfoot>

</table>

</div>
<p><a href="PrintSampIndex.html">&lt;&lt;回样例目录</a>
</p>
<script language="javascript" type="text/javascript"> 
	var LODOP; //声明为全局变量
	function myDesign01() {
		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM')); 		
		eval(document.getElementById('code1').value); 
		document.getElementById('code1').value=LODOP.PRINT_DESIGN();		

	};	
	function myPeview01() {		
		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM')); 		
		eval(document.getElementById('code1').value); 
		LODOP.PREVIEW();
	};
	function myDesign02() {
		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM')); 		
		eval(document.getElementById('code2').value); 
		document.getElementById('code2').value=LODOP.PRINT_DESIGN();		

	};	
	function myPeview02() {		
		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM')); 		
		eval(document.getElementById('code2').value); 
		LODOP.PREVIEW();
	};		
	
	
</script>
</body>
</html>