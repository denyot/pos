<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>WEB打印控件LODOP的样例三十五:获得打印结果和程序代码</title>

<script language="javascript" src="LodopFuncs.js"></script>
<object id="LODOP" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0> 
	<embed id="LODOP_EM" TYPE="application/x-print-lodop" width=0 height=0 PLUGINSPAGE="install_lodop.exe"></embed>
</object> 
</head>
<body>

<h2><font color="#009999">演示如何获得打印结果和程序代码：</font>
</h2>
<p>&nbsp;&nbsp;&nbsp; 
一般情况下，打印设计的程序代码需要用界面的“生成程序代码”菜单命令生成后，手工复制</p>  <p>出来融合到页面程序中使用。但实际上无论是<font color="#0000FF">直接打印、打印预览、打印维护</font>还是<font color="#0000FF">打印设计</font>，&nbsp;</p>  <p>
在运行结束或关闭窗口时都会返回相应的执行结果：</p>    
<p><font color="#0000FF">直接打印</font><font color="#000000">返回逻辑真假结果（1或true代表真，false或0代表假），表示是否打印成功；</font></p>  


<p><font color="#0000FF">打印维护</font><font color="#000000">和</font><font color="#0000FF">打印预览</font><font color="#000000">返回打印次数，大于0表示打印成功的次数；</font></p>  


<p><font color="#0000FF">打印设计</font><font color="#000000">窗口关闭后会自动生成程序代码并返给页面，页面程序可以进一步验证这些代码或提交保存；</font></p>  


<p><font size="2"><input type="button" value="打印预览" onclick="prn1_preview()">
<input type="button" value="打印维护" onclick="prn1_setup()">
<input type="button" value="打印设计" onclick="prn1_design()">
<input type="button" value="打印维护返回程序代码" onclick="prn2_setup()">
</font>

<form method="POST" action="--WEBBOT-SELF--">
  <p><textarea rows="14" id="S1" cols="107" >返回的结果值</textarea><font size="2">
  <input type="button" value="用这些代码执行打印预览" id="button02" style="display:none"  onclick="prn2_Preview()"> 
</font>

  </p>
</form>


<p><font size="2"><br>
</font>

<p><a href="PrintSampIndex.html">&lt;&lt;回样例目录</a></p>

<script language="javascript" type="text/javascript"> 
	var LODOP; //声明为全局变量 
	function prn1_preview() {	
		CreateOneFormPage();	
		document.getElementById('S1').value=LODOP.PREVIEW();
		document.getElementById('button02').style.display="none";	
	};
	function prn1_setup() {		
		CreateOneFormPage();
		document.getElementById('S1').value=LODOP.PRINT_SETUP();
		document.getElementById('button02').style.display="none";		
	};
	function prn1_design() {		
		CreateOneFormPage();
		document.getElementById('S1').value=LODOP.PRINT_DESIGN();
		document.getElementById('button02').style.display=""; 	
	};
	function prn2_setup() {		
		CreateOneFormPage();
		LODOP.SET_PRINT_MODE("PRINT_SETUP_PROGRAM",true);
		document.getElementById('S1').value=LODOP.PRINT_SETUP();
		document.getElementById('button02').style.display="none";		
	};	
	function prn2_Preview() {		
		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM')); 		
		eval(document.getElementById('S1').value); 
		LODOP.PREVIEW();
	};		
	function CreateOneFormPage(){
		LODOP=getLodop(document.getElementById('LODOP'),document.getElementById('LODOP_EM')); 
		LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_获得程序代码");
		LODOP.SET_PRINT_STYLE("FontName","黑体");
		LODOP.SET_PRINT_STYLE("FontSize",15);
		LODOP.ADD_PRINT_TEXT(12,46,175,30,"纯文本一");
		LODOP.ADD_PRINT_HTM(55,298,288,160,"<table border='1'>\n<tr>\n<td>表格11</td>\n<td>表格12</td>\n<td>表格13</td>\n</tr>\n<tr>\n<td>表格21</td>\n<td>表格22</td>\n<td>表格23</td>\n</tr>\n</table>");
		LODOP.SET_PRINT_STYLEA(0,"ItemName","htm-1");
		LODOP.ADD_PRINT_RECT(259,43,100,60,0,1);
		LODOP.ADD_PRINT_ELLIPSE(168,29,100,60,0,1);
		LODOP.ADD_PRINT_LINE(137,44,77,144,0,1);
		LODOP.ADD_PRINT_BARCODE(353,61,100,60,"128A","123456789012");
		LODOP.ADD_PRINT_CHART(218,216,497,198,1,"");	
	};	
</script> 




</body>
</html>